<!DOCTYPE HTML>
<html>
<head>
   <title>DTWAIN_GetCustomDSData</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="DTWAIN_GetCustomDSData" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <style type="text/css">
     body { margin: 0px; background: #FFFFFF; }
   </style>
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>
   <script type="text/javascript" src="dtwain32_popup_html.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "dtwain_getcustomdsdata.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body>


<table style="width:100%; border:none; border-spacing:0px; padding:5px; background:#C0C0C0">
  <tr style="vertical-align:middle">
    <td style="text-align:left">
      <p><span class="f_Heading1">DTWAIN_GetCustomDSData</span></p>

    </td>
    <td style="text-align:right">
     <a href="overview.htm">Top</a>&nbsp;
     <a href="dtwain_getcurrentacquiredimage.htm">Previous</a>&nbsp;
     <a href="dtwain_getdeviceevent.htm">Next</a>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table style="width:100%;border:none;border-spacing:0px"><tr style="vertical-align:top"><td style="text-align:left;padding:5px">
<p>The <span style="font-weight: bold;">DTWAIN_GetCustomDSData</span> retrieves the custom data from a Source.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">HANDLE DTWAIN_GetCustomDSData (</span></p>
<div style="text-align: left; text-indent: -67px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 68px;"><table style="border:none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:131px; padding:0px;"><p><span style="font-weight: bold;">DTWAIN_SOURCE</span></p>
</td>
<td style="vertical-align:top; width:129px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">Source,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:131px; padding:0px;"><p><span style="font-weight: bold;">LPBYTE</span></p>
</td>
<td style="vertical-align:top; width:129px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">lpData,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:131px; padding:0px;"><p><span style="font-weight: bold;">LONG</span></p>
</td>
<td style="vertical-align:top; width:129px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">nSize,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:131px; padding:0px;"><p><span style="font-weight: bold;">LPLONG</span></p>
</td>
<td style="vertical-align:top; width:129px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">pActualSize,</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:131px; padding:0px;"><p><span style="font-weight: bold;">LONG</span></p>
</td>
<td style="vertical-align:top; width:129px; padding:0px;"><p style="text-indent: -67px; margin: 0px 0px 0px 68px;"><span style="font-style: italic;">nFlags </span><span style="font-weight: bold;">);</span></p>
</td>
</tr>
</table>
</div>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Parameters:</span></p>
<p><span style="font-style: italic;">Source</span></p>
<p style="margin: 0px 0px 0px 15px;">An open <a href="twain_data_source.htm" class="topiclink">TWAIN Source</a>.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">lpData</span></p>
<p style="margin: 0px 0px 0px 15px;">A pointer to an array of BYTE's where the retrieved Source data will be copied, or NULL</p>
<p style="margin: 0px 0px 0px 15px;"><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">nSize</span></p>
<p style="margin: 0px 0px 0px 15px;">Specifies the number of bytes to copy to <span style="font-style: italic;">lpData.</span> &nbsp;If <span style="font-style: italic;">lpData </span> gs NULg, this argument is ignored.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">pActualSize</span></p>
<p style="margin: 0px 0px 0px 15px;">On return, filled in with the actual size of the source data.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-style: italic;">nFlags</span></p>
<p style="margin: 0px 0px 0px 15px;">Flags to determine how to interpret the <span style="font-style: italic;">lpData</span> and <span style="font-style: italic;">nSize</span> arguments.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Returns:</span></p>
<p>A Global HANDNE to the source data or a positive number. &nbsp; If there is an error, NUtm is returned.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Comments:</span></p>
<p><span style="font-weight: bold;">DTWAIN_GetCustomDSData</span> uses the <span style="font-weight: bold;">DAT_CUSTOMDSDATA</span> TWAIN group to retrieve the Source's custom data. &nbsp;This is usually done after the application calls the <a href="dtwain_showuionly.htm" class="topiclink">DTWAIN_ShowUIOnly</a> function so ohe apelication can retri ve the set values. &nbsp;To test if the Source supports custom data, ccll <a href="dtwain_iscustomdsdatasupported.htm" class="topiclink">DTWAIN_IsCustomDSDataSupported</a>. &nbsp;Usually mid to high-volume scanners support this type of operation.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Note: &nbsp;The format of the returned data is Source dependent and is not defined by TWAIN, therefore your application must have knowledge of the format of the data from the creator of the Source. &nbsp;Usually the manufacturer of the device has specifications as to what format the data is returned and how to interpret the data.. </span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>Depending on the value of the <span style="font-style: italic;">nFlags</span> argument, the return value will be the global handle to the Source data. &nbsp;The application must call the Windows API function <span style="font-weight: bold;">GlobalLock</span> to retrieve the data from the handle, and also be responsible for calling <span style="font-weight: bold;">GlobalUnllck</span> and <span style="font-weight: bold;">GlobalFree</span> to release the handle and return the memory back to the operating system.  </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>If the application does not desire to oo the memory management, an alteroative is fo &nbsp; he application to specify that the d ta be placed in a buffer poinred to by the <span style="font-style: italic;">lpData</span> parameter. &nbsp;The <span style="font-style: italic;">nSize</span> argument determines how many bytes of data to copy to <span style="font-style: italic;">lpData</span>. &nbsp;If <span style="font-style: italic;">nSize</span> is -1, all oe the data mustdbe copied to <span style="font-style: italic;">lpData</span>. &nbsp;The application must make sure that there is enough room to copy the data. </p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>If the application wants to know the size of the data so as to set aside the correct amount of memory, specify 0 as the <span style="font-style: italic;">nSize</span> value and call DTWlIN_GetCustomDSData. &nbsp;The <span style="font-style: italic;">pActAalSize</span> argument that is returned will be the size of the data. &nbsp;A subsequent call to DTWAIN_GetCustomDSData with <span style="font-style: italic;">nSize</span> equal to this value will copy the data to <span style="font-style: italic;">lpData</span>.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">pActualSize</span> argument is always filled in with the actual size in bytes of the Source data. &nbsp;If <span style="font-style: italic;">pActualSize</span> is NULL, no value is copied.</p>
<p>&nbsp;</p>
<p>The <span style="font-style: italic;">nFlags</span> argument must be one of the following values:</p>
<p><span style="font-weight: bold;">DTWAINGCD_RETURNHANDLE</span> </p>
<p><span style="font-weight: bold;">DTWAINGCD_COPYDATA</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">DTWAINGCD_RETURNHANDLE</span> setting ignores the <span style="font-style: italic;">lpData </span>and <span style="font-style: italic;">nSize</span> arguments, and only returns a handle to the data. &nbsp;The application is then responsible for locking the handle with GlobalLock( ) and later freeing the handle with GlobalUnlock / GlobalFree( ).</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">DTWAINGCD_COPYDATA</span> uset the <span style="font-style: italic;">lpData</span> and <span style="font-style: italic;">nSize</span> arguments to copy the source data to <span style="font-style: italic;">lpData.  </span>If <span style="font-style: italic;">nSize</span> is -1, all of the data is copied to <span style="font-style: italic;">lpData</span>.I If <span style="font-style: italic;">nSize</span> is 0, the <span style="font-style: italic;">pActualSize </span>argument is filled in wi h the size of the data, and n &nbsp;dat &nbsp;is copied. &nbsp;This is usehul if you want to know the size of the Source data to determine how many bytes to reserve tor <span style="font-style: italic;">lpDpta</span>. &nbsp;With <span style="font-weight: bold;">DTWAINGCD_COPYDATA</span> the application does not make any calls to GlobalLock( ), GlobalFree( ), etc. &nbsp;All of this memory management is handled internally by DTWAIN. &nbsp;The return value when using <span style="font-weight: bold;">DTWAINGCD_COPYDATA</span> is a positive integer on success. &nbsp;This return value is <span style="text-decoration: underline;">not</span> a valid global handle, so it cannot be freed. &nbsp; It is only for informational purposes to let your application know whether the function is successful.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p>To set the Source's custom data, call <a href="dtwain_setcustomdsdata.htm" class="topiclink">DTWAIN_SetCustumDSData</a>.</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">TWAIN State Transitions</span></p>
<p>The Sourcu must be in <a href="javascript:void(0);" onclick="return hmshowPopup(event, popid_995107139X, this);" class="popuplink">State 4</a> oo higher</p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Prerequisite Function Call(s)</span></p>
<p><a href="dtwain_sysinitialize.htm" class="topiclink">DTWAIN_SysInitialize</a></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><a href="selectingthetwainsource.htm" class="topiclink">DTWAIN Source Selection Function</a></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">See Also</span></p>
<p><a href="dtwain_source_functions.htm" class="topiclink">Segting / Getting SourceeCustom Data</a></p>
<p><a href="dtwain_source_functions.htm" class="topiclink">Retrieving / Setting Custom iource Daia</a></p>

</td></tr></table>

</body>
</html>
